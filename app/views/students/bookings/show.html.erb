<div class="row">
  <div class="col-lg-8">
    <div class="card">
      <div class="card-header">
        <h2 class="mb-0">Detalles de la Reserva</h2>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6 mb-3">
            <h6 class="text-muted">Mentor</h6>
            <p>
              <%= link_to mentor_path(@booking.availability.mentor) do %>
                <%= @booking.availability.mentor.full_name %>
              <% end %>
            </p>
          </div>
          <div class="col-md-6 mb-3">
            <h6 class="text-muted">Estado</h6>
            <p>
              <span class="badge bg-<%= case @booking.status
                when 'paid' then 'success'
                when 'pending' then 'warning'
                when 'rejected' then 'danger'
                else 'secondary'
              end %> fs-6">
                <%= @booking.status.capitalize %>
              </span>
            </p>
          </div>
          <div class="col-md-6 mb-3">
            <h6 class="text-muted">Fecha y Hora</h6>
            <p>
              <%= @booking.starts_at.strftime("%d de %B, %Y") %><br>
              <strong><%= @booking.starts_at.strftime("%H:%M") %> - 
                <%= @booking.ends_at.strftime("%H:%M") %></strong>
            </p>
          </div>
          <div class="col-md-6 mb-3">
            <h6 class="text-muted">Precio</h6>
            <p class="h4 text-success">
              $<%= number_with_precision(@booking.price, precision: 2) %>
            </p>
          </div>
          <% if @booking.availability.category %>
            <div class="col-md-6 mb-3">
              <h6 class="text-muted">Categoría</h6>
              <p>
                <span class="badge fs-6" style="background-color: <%= @booking.availability.category.color %>;">
                  <%= @booking.availability.category.name %>
                </span>
              </p>
            </div>
          <% end %>
          <% if @booking.preference_id.present? %>
            <div class="col-md-6 mb-3">
              <h6 class="text-muted">ID de Pago</h6>
              <p><code><%= @booking.preference_id %></code></p>
            </div>
          <% end %>
          <div class="col-12 mb-3">
            <h6 class="text-muted">Información del Mentor</h6>
            <% if @booking.availability.description.present? %>
              <p><%= @booking.availability.description %></p>
            <% end %>
            <p>
              <strong>Email:</strong> <%= @booking.availability.mentor.email %><br>
              <strong>Teléfono:</strong> <%= @booking.availability.mentor.phone %>
            </p>
          </div>
        </div>
        <div class="d-flex gap-2 mt-4">
          <%= link_to "Volver a Mis Reservas", students_bookings_path, class: "btn btn-secondary" %>
          <% if ['pending'].include?(@booking.status) %>
            <%= button_to "Cancelar Reserva", 
                cancel_students_booking_path(@booking), 
                method: :patch,
                class: "btn btn-danger",
                data: { turbo_confirm: "¿Estás seguro de cancelar esta reserva?" } %>
            <%= button_to "Pagar ahora", checkout_students_booking_path(@booking.id), method: :post, class: "btn btn-success", data: {turbo: false} %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <div class="col-lg-4">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">Acciones</h5>
      </div>
      <div class="card-body">
        <%= link_to "Perfil del Mentor", mentor_path(@booking.availability.mentor), class: "btn btn-primary w-100 mb-2" %>
        <%= link_to "Ver Categoría", category_path(@booking.availability.category), class: "btn btn-primary w-100" if @booking.availability.category %>
      </div>
    </div>
    <div class="card mt-3">
      <div class="card-header">
        <h5 class="mb-0">Información</h5>
      </div>
      <div class="card-body">
        <p class="small text-muted mb-0">
          Reserva creada el <%= @booking.created_at.strftime("%d/%m/%Y a las %H:%M") %>
        </p>
      </div>
    </div>
  </div>
</div>
